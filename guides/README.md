# 📚 Guides (Knowledge Base)

에이전트가 주문을 처리할 때 참조하는 외부 지식(Grounding Data)을 담고 있는 폴더입니다.

## 📂 주요 가이드 파일
- **order_guide.txt**: 판매 상품의 공식 명칭, 옵션, 단위, 가격 정보를 정의합니다. 에이전트는 이 정보를 기준으로 사용자의 요청이 유효한지 판단합니다.
- **address_guide.txt**: 배송 가능 지역과 표준 주소 입력 형식을 정의합니다. 불완전한 주소(예: '서울 강남')를 필터링하는 기준이 됩니다.

## 📝 관리 지침
- **유연한 업데이트**: 소스 코드를 수정할 필요 없이, 이 폴더의 텍스트 파일만 수정하면 에이전트의 판매 품목이나 배송 정책을 즉시 변경할 수 있습니다.
- **인식 규칙**: 상품 이름에 번호가 있거나(`1. 사과`), 필수 옵션(`(S/M/L)`)이 있는 경우 에이전트가 이를 엄격히 준수하도록 설계되어 있습니다.

---
<br>

# (추가) IOS 단축어 기능 설정 방법

iOS 단축어와 Google Apps Script를 활용하여, 특정 키워드가 포함된 문자(SMS) 수신 시 구글 스프레드시트 DB에 실시간으로 기록하는 수집 시스템 설정 방법을 설명합니다.

## 1. 구글 스프레드시트 DB 설정 (Backend)

데이터를 수신하고 저장할 클라우드 DB와 API 서버를 구축합니다.

### 1) 스프레드시트 준비
1. 새 구글 스프레드시트를 생성합니다.
2. 첫 번째 행(A1, B1, C1)에 다음과 같이 칼럼명을 입력합니다:
   - **날짜** / **발신자** / **내용**

### 2) Google Apps Script 작성
1. 상단 메뉴에서 **확장 프로그램 > Apps Script**를 클릭합니다.
2. 기존 코드를 삭제하고 아래 코드를 복사하여 붙여넣습니다.

```javascript
function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = JSON.parse(e.postData.contents);
  
  // 시트 마지막 행에 [수신 시간, 발신자 번호, 메시지 내용] 추가
  sheet.appendRow([new Date(), data.sender, data.message]);
  
  return ContentService.createTextOutput("Success");
}
```

### 3) 웹 앱 배포
1. Apps Script 상단 메뉴에서 **배포 > 새 배포**를 클릭합니다.
2. 유형 선택에서 **"웹 앱"**을 선택합니다.
3. 설정을 다음과 같이 완료합니다:
   * **설명**: SMS 수집 서버
   * **다음 사용자 인증 정보로 실행**: 나(본인 구글 계정)
   * **액세스 권한이 있는 사용자**: 모든 사용자 (Anyone)
4. **배포** 클릭 후 **액세스 승인** 절차를 진행합니다.
   * *주의: 경고 창이 뜨면 `Advanced(고급) > 프로젝트 이름(으)로 이동 > Allow(허용)`를 순서대로 클릭합니다.*
5. 배포 완료 후 생성된 **웹 앱 URL**을 복사해둡니다. (아이폰 단축어 설정 시 사용)

---

## 2. iOS 단축어 자동화 설정 (Client)

아이폰에 문자가 수신되었을 때 구글 스프레드시트 서버로 데이터를 실시간 전송하도록 설정합니다.

### 1) 자동화 트리거 설정
1. 아이폰에서 **단축어** 앱 실행 후 하단 **자동화** 탭을 선택합니다.
2. 우측 상단 **+** 버튼을 눌러 새 자동화를 생성합니다.
3. **메시지**를 선택하고 다음과 같이 설정합니다:
   * **메시지 포함 내용**: `주문` (DB로 보낼 특정 키워드 입력)
   * **실행**: 즉시 실행 (체크)
4. **다음**을 클릭합니다.

### 2) 데이터 전송 동작 정의
1. **새로운 빈 자동화 생성**을 클릭합니다.
2. **URL 콘텐츠 가져오기** 동작을 검색하여 추가합니다.
3. 설정을 다음과 같이 변경합니다:
   * **URL**: 아까 복사한 `구글 웹 앱 URL` 붙여넣기
   * **메소드**: `POST`
   * **본문 요청**: `JSON`
4. **새로운 필드 추가**를 통해 전송할 데이터(Key-Value)를 매핑합니다:

| 키(Key) | 유형 | 텍스트(Value) 선택 방법 |
| :--- | :--- | :--- |
| **sender** | 텍스트 | 키보드 위 리스트에서 `보낸 사람` 선택 |
| **message** | 텍스트 | 키보드 위 `단축어 입력` 클릭 > `콘텐츠` 선택 |

---

## 3. 작동 원리 및 결과



본 시스템은 **Sms-Mlops** 프로젝트의 데이터 수집 단계로, 다음과 같이 작동합니다:

1. **키워드 감지**: 판매자 아이폰에 "주문"이라는 단어가 포함된 문자가 도착합니다.
2. **자동 전송**: iOS 단축어가 이를 감지하여 설정된 API 서버(Google Apps Script)로 정보를 즉시 보냅니다.
3. **DB 저장**: 구글 스프레드시트에 **시간, 발신자 번호, 문자 내용**이 실시간으로 누적됩니다.
4. **후속 처리**: 수집된 비정형 데이터는 향후 AI 에이전트(Agent)를 통해 주문 정보로 정형화됩니다.